## PYNQ 总体架构

PYNQ 是 Python Productivity for  Zynq 的缩写，即 Zynq 的 Python 生产力，可以认为 PYNQ = Python + ZYNQ，是 Xilinx 推出的一种开放源代码框架，使用 Python 语言和库，使设计人员可以利用 Zynq 中可编程逻辑和微处理器的优势来快速构建高性 能的嵌入式应用程序。

从硬件角度来看，一块 PYNQ 开发板包括了 ARM 处理器部分和 FPGA 部分。其中 ARM 处理器部分运行 Ubuntu 操作系统，被称作 PS 端；FPGA 部分受控于 ARM 处理器，被称作 PL 端。以一块 PYNQ-Z2 开发板为例，PYNQ 的总体架构如下图所示。

![](F:\pynq-study\pic\pynq总体架构.PNG)

### PS 端

PS 端使用了 ARM 处理器，通过 SD 卡的启动方式运行了特制的 PYNQ 系统镜像，在功能上和普通的 Ubuntu 系统无异。

应用程序以 Python 语言进行开发，通常使用 Jupyter Notebook 来运行。应用程序在代码中调用 PYNQ 的 Python 应用程序编程接口（API）访问 FPGA 硬件，可以进行内存分配、函数调用等操作。

PYNQ 的应用程序编程接口（API）提供了用于 PS-PL 接口的 Linux 驱动程序，用于控制 PL 端。

### PL 端

PL 端是 FPGA 端，硬件库代码由硬件开发人员设计开发，最终生成叫做 Overlay 的硬件库，以 .bit 文件格式发布，软件开发人员在 PS 端中通过 Python API 接口加载对应的 .bit 文件，从而加载 Overlay 并在程序中调用，使用 FPGA 进行相应的计算。

PL 端可以在应用程序中加载 Overlay 进行调用，实际上具体调用了 Overlay 中叫做 IP 的单元。一个 IP 就是一个具有特定功能的硬件电路，例如在运行 CNN 模型的 Overlay 中，有进行卷积计算的 IP Conv 和进行池化计算的 IP Pool，应用程序调用这些 IP 构建完整的 CNN 模型。程序运行的时候，卷积计算或者池化计算可以通过 API 调用 PL 端的 IP 的部分进行加速，其它逻辑部分还是由 PS 端进行控制。

